<!DOCTYPE html>
<html>
<head>
  <!--
    ============================================================================
    BASE HREF CONFIGURATION
    ============================================================================
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
    ============================================================================
  -->
  <base href="$FLUTTER_BASE_HREF">

  <!-- 
    ============================================================================
    META TAGS - Character Set & Compatibility
    ============================================================================
  -->
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  
  <!--
    ============================================================================
    SEO & APP DESCRIPTION
    ============================================================================
    Update the description to accurately reflect your app's purpose
    ============================================================================
  -->
  <meta name="description" content="Atitia - Premium PG Management & Guest Experience Platform">
  <meta name="keywords" content="PG management, hostel booking, food menu, guest services">
  
  <!--
    ============================================================================
    iOS MOBILE WEB APP CONFIGURATION
    ============================================================================
    These meta tags ensure proper display on iOS devices when added to home screen
    ============================================================================
  -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Atitia">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!--
    ============================================================================
    FAVICON - Browser Tab Icon
    ============================================================================
  -->
  <link rel="icon" type="image/png" href="favicon.png"/>

  <!--
    ============================================================================
    PAGE TITLE - Shows in Browser Tab
    ============================================================================
  -->
  <title>Atitia - PG Management Platform</title>
  
  <!--
    ============================================================================
    WEB APP MANIFEST - PWA Configuration
    ============================================================================
    Defines how the app appears when installed on mobile devices
    ============================================================================
  -->
  <link rel="manifest" href="manifest.json">

  <!--
    ============================================================================
    FIREBASE SDK INITIALIZATION FOR WEB
    ============================================================================
    These scripts are REQUIRED for Firebase to work on web platform.
    
    IMPORTANT: 
    - Firebase SDK scripts must be loaded BEFORE the Flutter app initializes
    - Version 9.x+ uses modular SDK which is more efficient
    - Only include the services you actually use in your app
    
    Current Firebase Services Used:
    - firebase-app: Core Firebase functionality (REQUIRED)
    - firebase-auth: User authentication
    - firebase-firestore: Cloud Firestore database
    - firebase-storage: Cloud storage for files/images
    - firebase-messaging: Push notifications (FCM)
    - firebase-analytics: Analytics tracking
    - firebase-performance: Performance monitoring
    ============================================================================
  -->
  
  <!-- Firebase App (Core - REQUIRED for all Firebase features) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  
  <!-- Firebase Authentication -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  
  <!-- Firebase Firestore (Database) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
  
  <!-- Firebase Storage (File Storage) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js"></script>
  
  <!-- Firebase Cloud Messaging (Push Notifications) -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-messaging-compat.js"></script>
  
  <!-- Firebase Analytics -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics-compat.js"></script>
  
  <!-- Firebase Performance Monitoring -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-performance-compat.js"></script>

  <!--
    ============================================================================
    LOADING INDICATOR STYLES
    ============================================================================
    Shows a loading spinner while the Flutter app initializes
    ============================================================================
  -->
  <style>
    /* 
      Loading Screen Styles 
      Displays while Flutter app is initializing
    */
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(135deg, #7B61FF 0%, #9E8AFF 100%);
      font-family: 'Roboto', sans-serif;
    }

    /* Loading Container - Centers the loader */
    .loading-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #7B61FF 0%, #9E8AFF 100%);
      z-index: 9999;
    }

    /* App Logo */
    .loading-logo {
      width: 120px;
      height: 120px;
      margin-bottom: 32px;
      animation: pulse 2s ease-in-out infinite;
    }

    /* Spinner Animation */
    .loader {
      width: 48px;
      height: 48px;
      border: 4px solid rgba(255, 255, 255, 0.2);
      border-top-color: #ffffff;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* Loading Text */
    .loading-text {
      margin-top: 24px;
      color: #ffffff;
      font-size: 16px;
      font-weight: 500;
      letter-spacing: 0.5px;
    }

    /* Spinner Rotation Animation */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Logo Pulse Animation */
    @keyframes pulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.9; }
    }

    /* Hide loading screen when Flutter is ready */
    .flutter-loaded .loading-container {
      display: none;
    }

    /* Auto-hide loading screen after app initialization */
    @keyframes fadeOut {
      from { opacity: 1; }
      to { opacity: 0; }
    }
    
    .loading-container.hidden {
      animation: fadeOut 0.5s ease-out forwards;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <!--
    ============================================================================
    LOADING SCREEN
    ============================================================================
    Displayed while Flutter app initializes. Automatically hidden when ready.
    ============================================================================
  -->
  <div class="loading-container">
    <!-- App Logo (Update with your actual logo path if available) -->
    <svg class="loading-logo" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="white" opacity="0.9"/>
      <path d="M2 17L12 22L22 17V7L12 12L2 7V17Z" fill="white" opacity="0.7"/>
      <path d="M12 12V22" stroke="white" stroke-width="2" opacity="0.5"/>
    </svg>
    
    <!-- Loading Spinner -->
    <div class="loader"></div>
    
    <!-- Loading Text -->
    <p class="loading-text">Loading Atitia...</p>
  </div>

  <!--
    ============================================================================
    AUTO-HIDE LOADING SCREEN SCRIPT
    ============================================================================
    This script automatically hides the loading screen once Flutter is ready.
    
    HOW IT WORKS:
    1. Waits for DOM to be fully loaded
    2. Listens for Flutter framework ready event
    3. Hides loading screen with smooth fade-out animation
    4. Fallback: Hides after 10 seconds if Flutter event doesn't fire
    
    IMPORTANT:
    - Must be placed BEFORE flutter_bootstrap.js
    - Uses timeout as safety fallback
    ============================================================================
  -->
  <script>
    // ========================================================================
    // Loading Screen Auto-Hide Logic
    // ========================================================================
    // Listen for DOMContentLoaded to ensure DOM is ready
    window.addEventListener('DOMContentLoaded', function() {
      const loadingContainer = document.querySelector('.loading-container');
      
      // Function to hide loading screen with animation
      function hideLoadingScreen() {
        if (loadingContainer) {
          console.log('✅ Hiding loading screen - App ready!');
          loadingContainer.classList.add('hidden');
          
          // Remove from DOM after animation completes
          setTimeout(() => {
            loadingContainer.style.display = 'none';
          }, 500);
        }
      }
      
      // Method 1: Listen for Flutter framework ready event
      window.addEventListener('flutter-first-frame', function() {
        console.log('✅ Flutter first frame rendered');
        hideLoadingScreen();
      });
      
      // Method 2: Check if Flutter is already loaded (for fast loads)
      const checkFlutterReady = setInterval(() => {
        if (window.flutterApp || document.querySelector('flutter-view')) {
          console.log('✅ Flutter app detected');
          clearInterval(checkFlutterReady);
          hideLoadingScreen();
        }
      }, 100);
      
      // Method 3: Fallback timeout (safety net - hide after 10 seconds)
      setTimeout(() => {
        if (loadingContainer && !loadingContainer.classList.contains('hidden')) {
          console.log('⚠️ Timeout reached - hiding loading screen');
          clearInterval(checkFlutterReady);
          hideLoadingScreen();
        }
      }, 10000);
    });
  </script>

  <!--
    ============================================================================
    FLUTTER BOOTSTRAP SCRIPT
    ============================================================================
    This script loads and initializes the Flutter web application.
    The 'async' attribute ensures it doesn't block page rendering.
    
    IMPORTANT:
    - This MUST be loaded AFTER Firebase SDK scripts
    - The 'async' attribute is crucial for performance
    - Flutter will automatically hide the loading screen when ready
    ============================================================================
  -->
  <script src="flutter_bootstrap.js" async></script>

  <!--
    ============================================================================
    SERVICE WORKER REGISTRATION (Optional - for PWA support)
    ============================================================================
    Uncomment this section if you want PWA features like:
    - Offline functionality
    - Background sync
    - Push notifications
    - Install to home screen
    
    <script>
      // Register Service Worker for PWA functionality
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('/flutter_service_worker.js')
            .then(function(registration) {
              console.log('Service Worker registered successfully:', registration.scope);
            })
            .catch(function(error) {
              console.log('Service Worker registration failed:', error);
            });
        });
      }
    </script>
    ============================================================================
  -->
</body>
</html>
